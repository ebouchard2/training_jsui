webpackJsonpCoveo__temporary([19],{16:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),n=function(){function e(){}return e.addClassToSVGInContainer=function(t,o){var i=t.querySelector("svg");i.setAttribute("class",""+e.getClass(i)+o)},e.removeClassFromSVGInContainer=function(t,o){var i=t.querySelector("svg");i.setAttribute("class",e.getClass(i).replace(o,""))},e.addStyleToSVGInContainer=function(e,t){var o=e.querySelector("svg");i.each(t,function(e,t){o.style[t]=e})},e.getClass=function(e){var t=e.getAttribute("class");return t?t+" ":""},e}();t.SVGDom=n},322:function(e,t,o){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=o(8),s=o(2),l=o(4);o(436);var r=o(3),a=o(11),c=o(9),u=o(10),p=o(7),h=o(1),d=o(54),m=o(42),v=o(13),f=o(16),b=o(543),y=o(37),g=o(23),C=o(12),k=function(e){function t(o,i,n){var s=e.call(this,o,t.ID,n)||this;return s.element=o,s.options=i,s.bindings=n,s.previouslySelected=[],s.groupByRequestValues=[],s.isSticky=!1,s.options=c.ComponentOptions.initComponentOptions(o,t,i),s.element.title=s.options.title,s.buildContent(),r.$$(s.element).on("click",function(e){return s.handleClick(e)}),r.$$(s.element).setAttribute("tabindex","0"),s.bindKeyboardEvents(),s.bind.onRootElement(m.BreadcrumbEvents.populateBreadcrumb,function(e){return s.handlePopulateBreadcrumb(e)}),s.bind.onRootElement(m.BreadcrumbEvents.clearBreadcrumb,function(){return s.handleClearBreadcrumb()}),s.bind.onRootElement(a.QueryEvents.buildingQuery,function(e){return s.handleBuildingQuery(e)}),s.bind.onRootElement(a.QueryEvents.doneBuildingQuery,function(e){return s.handleDoneBuildingQuery(e)}),s.bind.onRootElement(a.QueryEvents.querySuccess,function(e){return s.handleQuerySuccess(e)}),s}return i(t,e),t.prototype.getValueContainer=function(){return this.valueContainer},t.prototype.getValueCaption=function(e){var t=e;return h.contains(h.keys(this.options.valueCaption),e)?(t=this.options.valueCaption[t]||t,u.l(t)):y.FacetUtils.tryToGetTranslatedCaption(this.options.field.toString(),t)},t.prototype.getSelectedCaptions=function(){var e=this;return h.map(this.getSelectedValues(),function(t){return e.getValueCaption(t)})},t.prototype.toggleContainer=function(){r.$$(this.valueContainer).hasClass("coveo-simplefilter-value-container-expanded")?this.closeContainer():this.openContainer()},t.prototype.selectValue=function(e,t){var o=this;void 0===t&&(t=!0),h.each(this.checkboxes,function(i){var n=o.getValueCaption(i.label);i.label!=e&&n!=e||i.checkbox.select(t)})},t.prototype.deselectValue=function(e){var t=this;h.each(this.checkboxes,function(o){var i=t.getValueCaption(o.label);o.label!=e&&i!=e||o.checkbox.reset()})},t.prototype.toggleValue=function(e){var t=this;h.each(this.checkboxes,function(o){var i=t.getValueCaption(o.label);o.label!=e&&i!=e||o.checkbox.toggle()})},t.prototype.resetSimpleFilter=function(){var e=this;h.each(this.checkboxes,function(t){t.checkbox.isSelected()&&e.deselectValue(t.label)})},t.prototype.openContainer=function(){r.$$(this.element).addClass("coveo-simplefilter-value-container-expanded"),this.valueContainer.addClass("coveo-simplefilter-value-container-expanded"),this.refreshValueContainer(),this.isSticky=!0,this.backdrop.hasClass("coveo-dropdown-background-active")||this.showBackdrop()},t.prototype.closeContainer=function(){r.$$(this.element).removeClass("coveo-simplefilter-value-container-expanded"),this.valueContainer.removeClass("coveo-simplefilter-value-container-expanded"),this.backdrop.hasClass("coveo-dropdown-background-active")&&this.hideBackdrop(),0==this.getSelectedLabeledCheckboxes().length&&(this.isSticky=!1)},t.prototype.getSelectedValues=function(){return h.map(this.getSelectedLabeledCheckboxes(),function(e){return e.label})},t.prototype.bindKeyboardEvents=function(){var e=this;r.$$(this.element).on("keyup",g.KeyboardUtils.keypressAction(g.KEYBOARD.ENTER,function(t){t.target==e.element?e.toggleContainer():e.toggleValue(r.$$(t.target).text())})),r.$$(this.element).on("blur",function(o){var i=o.relatedTarget;r.$$(i).parent(n.Component.computeCssClassName(t))||e.closeContainer()})},t.prototype.handleClick=function(e){e.stopPropagation(),e.target==this.element&&this.toggleContainer()},t.prototype.handleValueToggle=function(e){var t=this.getSelectedValues();this.circleElement.text(t.length.toString()),this.circleElement.removeClass("coveo-simplefilter-circle-hidden"),1==t.length?(this.setDisplayedTitle(this.getValueCaption(t[0])),this.element.title=this.getValueCaption(t[0])):(this.setDisplayedTitle(this.options.title),this.element.title=this.options.title,t.length<1&&this.circleElement.addClass("coveo-simplefilter-circle-hidden"));var o=e.isSelected()?C.analyticsActionCauseList.simpleFilterSelectValue:C.analyticsActionCauseList.simpleFilterDeselectValue;this.usageAnalytics.logSearchEvent(o,{simpleFilterTitle:this.options.title,simpleFilterSelectedValue:e.label,simpleFilterField:this.options.field}),this.queryController.executeQuery()},t.prototype.createCheckbox=function(e){var t=this,o=new d.Checkbox(function(){t.handleValueToggle(o)},this.getValueCaption(e));return o.getElement().title=u.l(e),r.$$(o.getElement()).setAttribute("tabindex","0"),{checkbox:o,label:e}},t.prototype.createCheckboxes=function(){var e=this;this.previouslySelected.length>0?(this.checkboxes=h.map(this.previouslySelected,function(t){return e.createCheckbox(t)}),h.each(this.checkboxes,function(t){e.previouslySelected.indexOf(t.label)>=0&&e.selectValue(t.label,!1)})):void 0!=this.options.values?this.checkboxes=h.map(this.options.values,function(t){return e.createCheckbox(t)}):void 0!=this.groupByRequestValues&&(this.checkboxes=h.map(this.groupByRequestValues,function(t){return e.createCheckbox(t)})),h.each(this.checkboxes,function(t){e.valueContainer.append(t.checkbox.getElement())}),this.checkboxes.length>0&&r.$$(r.$$(this.checkboxes[this.checkboxes.length-1].checkbox.getElement()).find(".coveo-checkbox-button")).on("blur",function(){e.closeContainer()})},t.prototype.createValueContainer=function(){this.valueContainer=r.$$("div",{className:"coveo-simplefilter-value-container"})},t.prototype.buildContent=function(){this.createValueContainer(),this.element.appendChild(this.buildSelect()),this.element.appendChild(this.valueContainer.el),this.findOrCreateWrapper().append(this.element),this.createBackdrop()},t.prototype.buildSelect=function(){var e=r.$$("span",{className:"coveo-simplefilter-select"});return this.selectTitle=r.$$("span",{className:"coveo-simplefilter-selecttext"},this.getValueCaption(this.options.title)),e.append(this.selectTitle.el),e.append(this.buildCircleElement()),e.append(this.buildSvgToggleUpIcon()),e.el},t.prototype.buildSvgToggleUpIcon=function(){var e=r.$$("span",null,v.SVGIcons.icons.arrowDown).el;return f.SVGDom.addClassToSVGInContainer(e,"coveo-simplefilter-toggle-down-svg"),e},t.prototype.buildCircleElement=function(){return this.circleElement=r.$$("span",{className:"coveo-simplefilter-circle coveo-simplefilter-circle-hidden"},this.getSelectedLabeledCheckboxes().length.toString()),this.circleElement.el},t.prototype.createBackdrop=function(){var e=this,t=r.$$(this.root).find(".coveo-dropdown-background");null==t?(this.backdrop=r.$$("div",{className:"coveo-dropdown-background"}),this.root.appendChild(this.backdrop.el)):this.backdrop=r.$$(t),this.backdrop.on("click",function(){return e.closeContainer()})},t.prototype.handlePopulateBreadcrumb=function(e){var t=this;if(this.getSelectedLabeledCheckboxes().length>0){var o=r.$$("div",{className:"coveo-simplefilter-breadcrumb"}),i=r.$$("span",{className:"coveo-simplefilter-breadcrumb-title"},this.options.title);o.append(i.el);var n=r.$$("span",{className:"coveo-simplefilter-breadcrumb-values"});o.append(n.el),h.each(this.getSelectedLabeledCheckboxes(),function(e){var o=r.$$("span",{className:"coveo-simplefilter-breadcrumb-value"},t.getValueCaption(e.label));n.append(o.el);var i=r.$$("span",{className:"coveo-simplefilter-breadcrumb-clear"},v.SVGIcons.icons.checkboxHookExclusionMore);f.SVGDom.addClassToSVGInContainer(i.el,"coveo-simplefilter-breadcrumb-clear-svg"),o.append(i.el),o.el.title=t.getValueCaption(e.label),r.$$(o).on("click",function(){return t.handleRemoveFromBreadcrumb(e)})}),e.breadcrumbs.push({element:o.el})}},t.prototype.handleRemoveFromBreadcrumb=function(e){e.checkbox.reset(),this.refreshValueContainer()},t.prototype.handleClearBreadcrumb=function(){this.usageAnalytics.logSearchEvent(C.analyticsActionCauseList.simpleFilterClearAll,{simpleFilterTitle:this.options.title,simpleFilterField:this.options.field}),this.resetSimpleFilter()},t.prototype.handleQuerySuccess=function(e){e.results.results.length>0?this.findOrCreateWrapper().removeClass("coveo-no-results"):this.findOrCreateWrapper().addClass("coveo-no-results"),void 0==this.options.values&&(this.groupByBuilder.groupBy(e),this.groupByRequestValues=this.groupByBuilder.getValuesFromGroupBy(),this.refreshValueContainer(),r.$$(this.element).hasClass("coveo-simplefilter-value-container-expanded")||(this.isSticky=!1))},t.prototype.handleBuildingQuery=function(e){p.Assert.exists(e),p.Assert.exists(e.queryBuilder);var t=this.getSelectedValues();t.length>0&&e.queryBuilder.advancedExpression.addFieldExpression(this.options.field.toString(),"==",t)},t.prototype.handleDoneBuildingQuery=function(e){void 0==this.options.values&&(p.Assert.exists(e),p.Assert.exists(e.queryBuilder),this.previouslySelected=this.getSelectedValues(),this.groupByBuilder=new b.SimpleFilterValues(this,this.options),this.groupByBuilder.handleDoneBuildingQuery(e))},t.prototype.getSelectedLabeledCheckboxes=function(){return h.filter(this.checkboxes,function(e){return e.checkbox.isSelected()})},t.prototype.setDisplayedTitle=function(e){this.selectTitle.text(this.getValueCaption(e))},t.prototype.getDisplayedTitle=function(){return this.selectTitle.text()},t.prototype.showBackdrop=function(){this.backdrop.addClass("coveo-dropdown-background-active")},t.prototype.hideBackdrop=function(){this.backdrop.removeClass("coveo-dropdown-background-active")},t.prototype.getBackdrop=function(){return this.backdrop},t.prototype.findOrCreateWrapper=function(){if(null==r.$$(this.root).find(".coveo-simplefilter-header-wrapper")){var e=r.$$("div",{className:"coveo-simplefilter-header-wrapper"});return e.insertBefore(this.element),e}var e=r.$$(this.root).find(".coveo-simplefilter-header-wrapper");return r.$$(e)},t.prototype.refreshValueContainer=function(){this.isSticky||(this.valueContainer.empty(),this.createCheckboxes()),0!=this.checkboxes.length||this.isSticky?r.$$(this.element).removeClass("coveo-simplefilter-empty"):r.$$(this.element).addClass("coveo-simplefilter-empty"),r.$$(this.circleElement).text(this.getSelectedLabeledCheckboxes().length.toString())},t.ID="SimpleFilter",t.doExport=function(){l.exportGlobally({SimpleFilter:t})},t.options={maximumNumberOfValues:c.ComponentOptions.buildNumberOption({defaultValue:5,min:0}),values:c.ComponentOptions.buildListOption(),field:c.ComponentOptions.buildFieldOption({required:!0}),title:c.ComponentOptions.buildStringOption({defaultValue:u.l("NoTitle")}),valueCaption:c.ComponentOptions.buildJsonOption()},t}(n.Component);t.SimpleFilter=k,s.Initialization.registerAutoCreateComponent(k)},436:function(e,t){},543:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(436);var i=o(1),n=function(){function e(e,t){this.simpleFilter=e,this.options=t,this.groupByRequestValues=[]}return e.prototype.getValuesFromGroupBy=function(){return this.groupByRequestValues},e.prototype.groupBy=function(e){var t=this;this.groupByRequestValues=[];var o=e.results.groupByResults;o.length>0&&void 0!=this.position&&i.each(o[this.position].values,function(e){t.groupByRequestValues.indexOf(e.lookupValue)<0&&t.groupByRequestValues.push(e.lookupValue)})},e.prototype.handleDoneBuildingQuery=function(e){var t=e.queryBuilder;this.putGroupByIntoQueryBuilder(t)},e.prototype.putGroupByIntoQueryBuilder=function(e){var t=this.createBasicGroupByRequest();e.groupByRequests.push(t),this.position=e.groupByRequests.length-1},e.prototype.createBasicGroupByRequest=function(){return{field:this.options.field,maximumNumberOfValues:this.options.maximumNumberOfValues,injectionDepth:1e3}},e}();t.SimpleFilterValues=n}});